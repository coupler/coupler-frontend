<app-client-error *ngIf="clientError" [error]="clientError">
</app-client-error>
<ng-template [ngIf]="job">
  <h2>Linkage: {{linkage.name}}, Job {{job.id}}</h2>

  <table>
    <thead>
      <tr>
        <th>Status</th>
        <th>Started At</th>
        <th>Ended At</th>
        <th *ngIf="job.error">Error</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          {{job.status}}
          <i *ngIf="!job.isStopped()" class="fa fa-cog fa-spin" style="font-size: larger"></i>
        </td>
        <td>
          <ng-template [ngIf]="job.startedAt" [ngIfElse]="jobNotStarted">
            {{job.startedAt | date:"short"}}
          </ng-template>
          <ng-template #jobNotStarted>
            Not yet started
          </ng-template>
        </td>
        <td>
          <ng-template [ngIf]="job.endedAt" [ngIfElse]="jobNotEnded">
            {{job.endedAt | date:"short"}}
          </ng-template>
          <ng-template #jobNotEnded>
            Not yet ended
          </ng-template>
        </td>
        <td *ngIf="job.error">{{job.error}}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="job.linkageResult && job.status == 'finished'" class="results">
    <h3>Results</h3>
    <p>
      <strong>Number of matches:</strong>
      {{job.linkageResult.matchCount}}
    </p>

    <app-linkage-result-detail
      [linkageResult]="job.linkageResult"
      [linkage]="linkage">
    </app-linkage-result-detail>
  </div>

  <button type="button" class="btn btn-secondary" (click)="goBack()">Back</button>
</ng-template>
